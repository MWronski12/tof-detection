<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TMF882X Core Driver: TMF882X Driver User API Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TMF882X Core Driver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">TMF882X Driver User API Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Version 1.3</p>
<h1>Contents </h1>
<ol type="1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#tof-char-device">ToF Char Device</a></li>
<li><a href="#tof-input-device">ToF Input Device</a></li>
<li><a href="#sysfs-attributes">SysFS Attributes</a></li>
<li><a href="#factory-calibration">Factory Calibration</a></li>
<li><a href="#custom-spad-configuration">Custom SPAD Configuration</a></li>
</ol>
<h1>Introduction </h1>
<p>This document describes User Application Programming Interface (API) to the TMF882X Linux Kernel Driver.</p>
<h1>ToF Char Device </h1>
<p>The TMF882X driver registers a character device with the Linux system called **_/dev/tof_**. The ToF char device is used for streaming messages from the driver. After module probe, the TMF882X device is in a low power state with the **_APPLICATION_** mode loaded. Opening the ToF char device will bring the device out of standby to idle state.</p>
<p>Common types of messages include:</p>
<ul>
<li>Histogram data</li>
<li>Measurement Result data</li>
<li>Driver error codes</li>
</ul>
<p>All messages have a common header format with an identifier and message length. The driver buffers messages in an internal FIFO that user space applications may read. When reading from the ToF char device the user buffer should be large enough for at least one message, the driver will fill the buffer with as many messages that will fit completely. The driver will never put partial messages in the user buffer.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: If the user buffer is smaller than the next message in the FIFO the driver will return an error. </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: If the driver FIFO is empty by default the driver will block until a message is available </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 3: Since the ToF char device is a message stream, <em>seek()</em> operations and file <em>offset</em> are not supported </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 4: Since the ToF char device is a message stream, the ToF char device will never return EOF </p>
</blockquote>
<p>Example 'C' code reading from ToF Char device:</p>
<div class="fragment"><div class="line">char buf[TMF882X_MAX_MSG_SIZE];     /* buffer to hold at least 1 message */</div>
<div class="line">int off = 0;</div>
<div class="line">int ret = 0;</div>
<div class="line">while (1) {</div>
<div class="line"> </div>
<div class="line">    /* read as many messages as our buffer size allows */</div>
<div class="line">    ret = read(fd, buf, sizeof(buf)));</div>
<div class="line">    off = 0;</div>
<div class="line"> </div>
<div class="line">    /* loop through the messages */</div>
<div class="line">    while (ret &gt; 0 &amp;&amp; off &lt; ret) {</div>
<div class="line">        struct tmf882x_msg *msg = buf + off;</div>
<div class="line"> </div>
<div class="line">        switch (msg-&gt;hdr.msg_id) {</div>
<div class="line">            case ID_ERROR:      /* Error code message received */</div>
<div class="line">               struct tmf882x_msg_error *err = &amp;msg-&gt;err_msg;</div>
<div class="line">               *** Handle msg &#39;err&#39; ***</div>
<div class="line">               break;</div>
<div class="line">            case .</div>
<div class="line">                 .</div>
<div class="line">                 .</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        off += msg-&gt;hdr.msg_len;     /* Move to next message in buffer */</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><p>Refer to **_./include/linux/i2c/ams/tmf882x.h_** for a detailed description of message definitions.</p>
<h1>ToF Input Device </h1>
<p>The TMF882X registers an input character device with the Linux Input system. After module probe, the TMF882X device is in a low power state with the **_APPLICATION_** mode loaded. Opening the ToF input device will bring the device out of standby and start measurements with the default configuration.</p>
<p>Below is the Linux Kernel definition of an input event:</p>
<div class="fragment"><div class="line">struct input_event {</div>
<div class="line">    struct timeval time;</div>
<div class="line">    __u16 type;</div>
<div class="line">    __u16 code;</div>
<div class="line">    __s32 value;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Only measurement results are published on the input device. The TMF882X driver registers an input device with the following encoding:</p>
<div class="fragment"><div class="line">type = EV_ABS;</div>
<div class="line">code = channel;</div>
<div class="line">val(31:24) = sub capture index</div>
<div class="line">val(23:16) = confidence;</div>
<div class="line">val(15:0) = distance in millimeters;</div>
</div><!-- fragment --><h1>SysFS Attributes </h1>
<p>General configuration of the TMF882X kernel driver is done through Sysfs attributes.</p>
<h2>List of SysFS Attributes </h2>
<p>Sysfs attributes marked as mode == 'N/A' are valid to use in any mode.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Mode   </th><th class="markdownTableHeadNone">SysFS Attribute   </th><th class="markdownTableHeadCenter">Read / Write   </th><th class="markdownTableHeadCenter">Format    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#mode">mode</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#chip_enable">chip_enable</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#driver_debug">driver_debug</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#firmware_version">firmware_version</a>   </td><td class="markdownTableBodyCenter">R   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#registers">registers</a>   </td><td class="markdownTableBodyCenter">R   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#register_write">register_write</a>   </td><td class="markdownTableBodyCenter">W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#request_ram_patch">request_ram_patch</a>   </td><td class="markdownTableBodyCenter">W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#device_uid">device_uid</a>   </td><td class="markdownTableBodyCenter">R   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyNone"><a href="#device_revision">device_revision</a>   </td><td class="markdownTableBodyCenter">R   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appcapture">app/capture</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appshort_range_mode">app/short_range_mode</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appreport_period_ms">app/report_period_ms</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appiterations">app/iterations</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appalg_setting">app/alg_setting</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#apppower_cfg">app/power_cfg</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appgpio_0">app/gpio_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appgpio_1">app/gpio_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#apphistogram_dump">app/histogram_dump</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appconf_threshold">app/conf_threshold</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#applow_threshold">app/low_threshold</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#apphigh_threshold">app/high_threshold</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#apppersistence">app/persistence</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appzone_mask">app/zone_mask</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appmode_8x8">app/mode_8x8</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appspad_map_id">app/spad_map_id</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appxoff_q1_0">app/xoff_q1_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appxoff_q1_1">app/xoff_q1_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appyoff_q1_0">app/yoff_q1_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appyoff_q1_1">app/yoff_q1_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appxsize_0">app/xsize_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appxsize_1">app/xsize_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appysize_0">app/ysize_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appysize_1">app/ysize_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appspad_mask_0">app/spad_mask_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appspad_mask_1">app/spad_mask_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appspad_map_0">app/spad_map_0</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appspad_map_1">app/spad_map_1</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appcommit_spad_cfg">app/commit_spad_cfg</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appreset_spad_cfg">app/reset_spad_cfg</a>   </td><td class="markdownTableBodyCenter">W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appclock_compensation">app/clock_compensation</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#apposc_trim">app/osc_trim</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#apposc_trim_freq">app/osc_trim_freq</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">string    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appfactory_calibration">app/factory_calibration</a>   </td><td class="markdownTableBodyCenter">R   </td><td class="markdownTableBodyCenter">bin    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">0x2   </td><td class="markdownTableBodyNone"><a href="#appcalibration_data">app/calibration_data</a>   </td><td class="markdownTableBodyCenter">R/W   </td><td class="markdownTableBodyCenter">bin   </td></tr>
</table>
<h2>SysFS Attribute Details </h2>
<h3>mode</h3>
<p>Read or Write the current mode of the TMF882X device.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x80   </td><td class="markdownTableBodyNone">Bootloader    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x03   </td><td class="markdownTableBodyNone">Application   </td></tr>
</table>
<h3>chip_enable</h3>
<p>Read or Write the CE GPIO line to control power to the TMF882X device.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Unpowered    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Powered   </td></tr>
</table>
<h3>driver_debug</h3>
<p>Read or Write the driver verbosity log level</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">No debug logging    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Debug logging   </td></tr>
</table>
<h3>firmware_version</h3>
<p>Dump the current mode's firmware version string.</p>
<h3>registers</h3>
<p>Dump the I2C register map of the TMF882X device.</p>
<h3>register_write</h3>
<p>Write a value to a register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>:<em>bb</em>   </td><td class="markdownTableBodyNone">Write value <em>bb</em> to register <em>aa</em>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><em>aa</em>:<em>bb</em>:<em>cc</em>   </td><td class="markdownTableBodyNone">Write value <em>bb</em> to register <em>aa</em> with mask <em>cc</em>   </td></tr>
</table>
<h3>request_ram_patch</h3>
<p>Write any value to request a RAM patch firmware download. The TMF882X Linux kernel driver uses the Linux Firmare Framework to request the firmware **/lib/firmware/tmf882x_firmware.bin**. The driver assumes the <em>APPLICATION</em> mode to be running after a successful FWDL.</p>
<h3>device_uid</h3>
<p>Dump the current TMF882X device Unique ID or serial number string.</p>
<h3>device_revision</h3>
<p>Dump the current TMF882X device revision string.</p>
<h3>app/capture</h3>
<p>Read or Write the Time-of-Flight distance measurement state.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Stop measurements    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Start measurements   </td></tr>
</table>
<h3>app/short_range_mode</h3>
<p>Read or Write the Time-of-Flight short-range mode state.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Short Range mode Disabled    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Short Range mode Enabled   </td></tr>
</table>
<h3>app/report_period_ms</h3>
<p>Read or Write measurement reporting period in milliseconds. Configuring a report period shorter than the time necessary to complete the measurements based on the current configuration results in a reporting period at the fastest possible rate.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone">The reporting period in <em>aa</em> milliseconds   </td></tr>
</table>
<h3>app/iterations</h3>
<p>Read or Write the measurement iterations of the TMF882X device.</p>
<blockquote class="doxtable">
<p><b>Note</b>: Iterations may not match exactly what was set by the user due to the TMF882X device only supporting measurement iterations in units of <em>iterations</em> * 1024 </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone">The measurement iterations in <em>aa</em>   </td></tr>
</table>
<h3>app/alg_setting</h3>
<p>Read or Write the current ToF algorithm measurement settings. Please refer to the TMF882X datasheet for details on the <b>alg_setting</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>alg_setting</b> register setting   </td></tr>
</table>
<h3>app/power_cfg</h3>
<p>Read or Write the current ToF power configuration settings. Please refer to the TMF882X datasheet for details on the <b>power_cfg</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>power_cfg</b> register setting   </td></tr>
</table>
<h3>app/gpio_0</h3>
<p>Read or Write the current GPIO_0 setting. Please refer to the TMF882X datasheet for details on the <b>gpio_0</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>gpio_0</b> register setting   </td></tr>
</table>
<h3>app/gpio_1</h3>
<p>Read or Write the current GPIO_1 setting. Please refer to the TMF882X datasheet for details on the <b>gpio_1</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>gpio_1</b> register setting   </td></tr>
</table>
<h3>app/histogram_dump</h3>
<p>Read or Write the current histogram dump setting. Please refer to the TMF882X datasheet for details on the <b>histogram_dump</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>histogram_dump</b> register setting   </td></tr>
</table>
<h3>app/conf_threshold</h3>
<p>Read or Write the current confidence threshold setting. Please refer to the TMF882X datasheet for details on the <b>confidence_threshold</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>confidence_threshold</b> register setting   </td></tr>
</table>
<h3>app/low_threshold</h3>
<p>Read or Write the current low distance threshold setting. Please refer to the TMF882X datasheet for details on the <b>low_threshold</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>low_threshold</b> register setting   </td></tr>
</table>
<h3>app/high_threshold</h3>
<p>Read or Write the current high distance threshold setting. Please refer to the TMF882X datasheet for details on the <b>high_threshold</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>high_threshold</b> register setting   </td></tr>
</table>
<h3>app/persistence</h3>
<p>Read or Write the current persistence setting. Please refer to the TMF882X datasheet for details on the <b>persistence</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>persistence</b> register setting   </td></tr>
</table>
<h3>app/zone_mask</h3>
<p>Read or Write the current zone mask setting. Please refer to the TMF882X datasheet for details on the <b>zone_mask</b> register.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>zone_mask</b> register setting   </td></tr>
</table>
<h3>app/mode_8x8</h3>
<p>Read or Write to enable/disable the 8x8 Mode. Please refer to the TMF8828 datasheet for details on the 8x8 Mode.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Only TMF8828 devices support 8x8 mode </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: The driver output result message types do not change. The user </p>
</blockquote>
<p>application can group the 8x8 result messages by collecting <em>four</em> result messages from the driver and ensuring the lower 2 bits of the result numbers in the messages are b'<code>00</code>, b'<code>01</code>, b'<code>02</code>, b'<code>03</code></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Normal mode    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">8x8 Mode (if supported)   </td></tr>
</table>
<h3>app/spad_map_id</h3>
<p>Read or Write the current SPAD map ID setting. Please refer to the TMF882X datasheet for details on the <b>spad_map_id</b> register.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Calibration data must be updated when changing the SPAD configuration <b>Note</b> 2: The driver spad configuration should be reset by writing to <b><a href="#appreset_spad_cfg">app/reset_spad_cfg</a></b> before reading from any of the following attributes: </p>
</blockquote>
<ul>
<li><a href="#appxoff_q1_0">app/xoff_q1_0</a></li>
<li><a href="#appxoff_q1_1">app/xoff_q1_1</a></li>
<li><a href="#appyoff_q1_0">app/yoff_q1_0</a></li>
<li><a href="#appyoff_q1_1">app/yoff_q1_1</a></li>
<li><a href="#appxsize_0">app/xsize_0</a></li>
<li><a href="#appxsize_1">app/xsize_1</a></li>
<li><a href="#appysize_0">app/ysize_0</a></li>
<li><a href="#appysize_1">app/ysize_1</a></li>
<li><a href="#appspad_mask_0">app/spad_mask_0</a></li>
<li><a href="#appspad_mask_1">app/spad_mask_1</a></li>
<li><a href="#appspad_map_0">app/spad_map_0</a></li>
<li><a href="#appspad_map_1">app/spad_map_1</a></li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the <b>spad_map_id</b> register setting   </td></tr>
</table>
<h3>app/xoff_q1_0</h3>
<p>Read or Write the X-direction offset of the SPAD map in fixed point Q1 format for sub capture 0 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the X-direction offset in Q1 fixed point   </td></tr>
</table>
<h3>app/xoff_q1_1</h3>
<p>Read or Write the X-direction offset of the SPAD map in fixed point Q1 format for sub capture 1 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the X-direction offset in Q1 fixed point   </td></tr>
</table>
<h3>app/yoff_q1_0</h3>
<p>Read or Write the Y-direction offset of the SPAD map in fixed point Q1 format for sub capture 0 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the Y-direction offset in Q1 fixed point   </td></tr>
</table>
<h3>app/yoff_q1_1</h3>
<p>Read or Write the Y-direction offset of the SPAD map in fixed point Q1 format for sub capture 1 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the Y-direction offset in Q1 fixed point   </td></tr>
</table>
<h3>app/xsize_0</h3>
<p>Read or Write the number of columns for the SPAD configuration for sub capture 0 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the X-direction size in number of SPADs   </td></tr>
</table>
<h3>app/xsize_1</h3>
<p>Read or Write the number of columns for the SPAD configuration for sub capture 1 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the X-direction size in number of SPADs   </td></tr>
</table>
<h3>app/ysize_0</h3>
<p>Read or Write the number of rows for the SPAD configuration for sub capture 0 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the Y-direction size in number of SPADs   </td></tr>
</table>
<h3>app/ysize_1</h3>
<p>Read or Write the number of rows for the SPAD configuration for sub capture 1 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone"><em>aa</em> is the Y-direction size in number of SPADs   </td></tr>
</table>
<h3>app/spad_mask_0</h3>
<p>Read or Write the SPAD enable/disable mask for sub capture 0 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: Values are white-space separated list of zero and non-zero values. Total number of values when reading/writing should equal <b><a href="#app/xsize_0">app/xsize_0</a> * <a href="#app/ysize_0">app/ysize_0</a></b> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Disable SPAD    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Non-Zero   </td><td class="markdownTableBodyNone">Enable SPAD   </td></tr>
</table>
<h3>app/spad_mask_1</h3>
<p>Read or Write the SPAD enable/disable mask for sub capture 1 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: Values are white-space separated list of zero and non-zero values. Total number of values when reading/writing should equal <b><a href="#appxsize_1">app/xsize_1</a> * <a href="#appysize_1">app/ysize_1</a></b> </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Disable SPAD    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Non-Zero   </td><td class="markdownTableBodyNone">Enable SPAD   </td></tr>
</table>
<h3>app/spad_map_0</h3>
<p>Read or Write the SPAD channel mapping for sub capture 0 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: Values are white-space separated list of values. Total number of values when reading/writing should equal <b><a href="#appxsize_0">app/xsize_0</a> * <a href="#appysize_0">app/ysize_0</a></b> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 3: Channel 0 should not be used </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 4: Channels 1 and 8/9 cannot be mapped on the same row. </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone">Map SPAD to channel <em>aa</em>   </td></tr>
</table>
<h3>app/spad_map_1</h3>
<p>Read or Write the SPAD channel mapping for sub capture 1 of time-multiplexed measurements.</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: Values are white-space separated list of values. Total number of values when reading/writing should equal <b><a href="#appxsize_1">app/xsize_1</a> * <a href="#appysize_1">app/ysize_1</a></b> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 3: Channel 0 should not be used </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 4: Channels 1 and 8/9 cannot be mapped on the same row. </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone">Map SPAD to channel <em>aa</em>   </td></tr>
</table>
<h3>app/commit_spad_cfg</h3>
<p>Read or Write whether the SPAD configuration SysFS attributes are committed to the device configuration as a single bulk configuration:</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<ul>
<li><a href="#appxoff_q1_0">app/xoff_q1_0</a></li>
<li><a href="#appxoff_q1_1">app/xoff_q1_1</a></li>
<li><a href="#appyoff_q1_0">app/yoff_q1_0</a></li>
<li><a href="#appyoff_q1_1">app/yoff_q1_1</a></li>
<li><a href="#appxsize_0">app/xsize_0</a></li>
<li><a href="#appxsize_1">app/xsize_1</a></li>
<li><a href="#appysize_0">app/ysize_0</a></li>
<li><a href="#appysize_1">app/ysize_1</a></li>
<li><a href="#appspad_mask_0">app/spad_mask_0</a></li>
<li><a href="#appspad_mask_1">app/spad_mask_1</a></li>
<li><a href="#appspad_map_0">app/spad_map_0</a></li>
<li><a href="#appspad_map_1">app/spad_map_1</a></li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">SPAD configuration contains uncommitted changes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">SPAD configuration is committed to the device   </td></tr>
</table>
<h3>app/reset_spad_cfg</h3>
<p>Write-only reset the driver-cached SPAD configuration by synchronizing to the spad configuration on the device:</p>
<blockquote class="doxtable">
<p><b>Note</b> 1: Refer to <a href="#custom-spad-configuration">Custom SPAD Configuration</a> </p>
</blockquote>
<ul>
<li><a href="#appxoff_q1_0">app/xoff_q1_0</a></li>
<li><a href="#appxoff_q1_1">app/xoff_q1_1</a></li>
<li><a href="#appyoff_q1_0">app/yoff_q1_0</a></li>
<li><a href="#appyoff_q1_1">app/yoff_q1_1</a></li>
<li><a href="#appxsize_0">app/xsize_0</a></li>
<li><a href="#appxsize_1">app/xsize_1</a></li>
<li><a href="#appysize_0">app/ysize_0</a></li>
<li><a href="#appysize_1">app/ysize_1</a></li>
<li><a href="#appspad_mask_0">app/spad_mask_0</a></li>
<li><a href="#appspad_mask_1">app/spad_mask_1</a></li>
<li><a href="#appspad_map_0">app/spad_map_0</a></li>
<li><a href="#appspad_map_1">app/spad_map_1</a></li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Driver SPAD configuration is synchronized with the device   </td></tr>
</table>
<h3>app/clock_compensation</h3>
<p>Read or Write whether the driver performs clock skew compensation.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Clock skew compensation is disabled    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">non-zero   </td><td class="markdownTableBodyNone">Clock skew compensation is enabled   </td></tr>
</table>
<h3>app/osc_trim</h3>
<p>Read or Write whether the driver performs OSC trimming</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Oscillator trimming is disabled    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">non-zero   </td><td class="markdownTableBodyNone">Oscillator trimming is enabled   </td></tr>
</table>
<h3>app/osc_trim_freq</h3>
<p>Write the target device OSC frequency or Read the current device OSC frequency</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><em>aa</em>   </td><td class="markdownTableBodyNone">Frequency in Hz   </td></tr>
</table>
<h3>app/factory_calibration</h3>
<p>Perform a factory calibration and dump the factory calibration binary data. Please refer to the TMF882X datasheet for details on <b>factory calibration</b> configuration.</p>
<h3>app/calibration_data</h3>
<p>Read or Write the calibration binary data. Please refer to the TMF882X datasheet for details on <b>factory calibration</b> configuration.</p>
<blockquote class="doxtable">
<p><b>Note</b>: The TMF882X device continuously updates calibration data during runtime. For best performance, client applications should periodically save the calibration data and write it back to the TMF882X device after power loss or a SPAD configuration change. </p>
</blockquote>
<h1>Factory Calibration </h1>
<p>The TMF882X device supports a calibration data read/write mechanism (see <b>factory calibration</b> details in the TMF882X datasheet). Factory calibration provides a default calibration data. The TMF882X internal calibration data is updated at runtime based off captured measurements. For best performance, the host should periodically save the calibration data that should be written back to the device after any power loss or SPAD configuration change.</p>
<h2>Performing Factory Calibration </h2>
<p>The TMF882X driver factory calibration process will stop all measurements, disable any histogram dump settings, then perform the the factory calibration command as documented in the TMF882X datasheet. The factory calibration process can be performed by reading the SysFS <a href="#appfactory_calibration">app/factory_calibration</a>.</p>
<p>&gt;Example performing factory calibration: </p><blockquote class="doxtable">
<p>&gt;``` cat factory_calibration &gt; calib.bin &gt;``` </p>
</blockquote>
<h2>Reading Measurement-Updated Calibration Data </h2>
<p>The current measurement-updated calibration data can be read from the TMF882X device by reading the SysFS <a href="#appcalibration_data">app/calibration_data</a>. Any active measurements will be stopped, and then resumed after updating the calibration data if there were no errors.</p>
<p>&gt;Example reading current calibration data: </p><blockquote class="doxtable">
<p>&gt;``` cat calibration_data &gt; calib.bin &gt;``` </p>
</blockquote>
<h2>Writing Calibration Data </h2>
<p>Updating the TMF882X calibration data can be used to write the factory calibration, or a measurement-updated calibration. Any active measurements will be stopped, and then resumed after updating the calibration data if there were no errors. The calibration data can be written to the device through SysFS by writing to <a href="#appcalibration_data">app/calibration_data</a>.</p>
<p>&gt;Example writing calibration data to TMF882X device: </p><blockquote class="doxtable">
<p>&gt;``` cat calib.bin &gt; app/calibration_data &gt;``` </p>
</blockquote>
<h1>Custom SPAD Configuration </h1>
<p>The TMF882X device has several predefined SPAD configurations as detailed in TMF882X datasheet, but also supports user custom SPAD configurations.</p>
<p>Order of Operations for Custom SPAD configuration:</p>
<ol type="1">
<li>Set <a href="#appspad_map_id">app/spad_map_id</a> to a custom SPAD configuration value as detailed in the TMF882X datasheet.</li>
<li>Set the X and Y SPAD mask offsets in<ul>
<li><a href="#appxoff_q1_0">app/xoff_q1_0</a></li>
<li><a href="#appyoff_q1_0">app/yoff_q1_0</a></li>
</ul>
</li>
<li>Set the X and Y SPAD mask size in<ul>
<li><a href="#appxsize_0">app/xsize_0</a></li>
<li><a href="#appysize_0">app/ysize_0</a></li>
</ul>
</li>
<li>Set the SPAD enable mask in<ul>
<li><a href="#appspad_mask_0">app/spad_mask_0</a></li>
</ul>
</li>
<li>Set the SPAD channel mapping in<ul>
<li><a href="#appspad_map_0">app/spad_map_0</a></li>
</ul>
</li>
<li>Commit the custom SPAD configuration by writing to<ul>
<li><a href="#appcommit_spad_cfg">app/commit_spad_config</a></li>
</ul>
</li>
</ol>
<blockquote class="doxtable">
<p><b>Note</b> 1: The SPAD mask and SPAD channel mapping should be equal in size to the <b><a href="#appxsize_0">app/xsize_0</a> * <a href="#appysize_0">app/ysize_0</a></b> </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 2: If using a time-multiplexed custom SPAD configuration, the <em>**N**th</em> sub-capture SPAD configuration can be configured by using the corresponding SysFS SPAD config attributes with postfix __**N**_ </p>
</blockquote>
<blockquote class="doxtable">
<p><b>Note</b> 3: The driver-cached spad configuration can be reset to the current </p>
</blockquote>
<p>device spad configuration by writing to <b><a href="#appreset_spad_cfg">app/reset_spad_cfg</a></b></p>
<p>Example custom SPAD configuration with two time-multiplexed sub captures:</p>
<div class="fragment"><div class="line"># Set SPAD map ID to custom configuration with two multiplexed subcaptures</div>
<div class="line">#  that combine to a 4x4 zone</div>
<div class="line">echo 15 &gt; app/spad_map_id</div>
<div class="line"> </div>
<div class="line"># Move FOV South one SPAD for both subcaptures</div>
<div class="line">echo 0 &gt; app/xoff_q1_0</div>
<div class="line">echo -2 &gt; app/yoff_q1_0</div>
<div class="line">echo 0 &gt; app/xoff_q1_1</div>
<div class="line">echo -2 &gt; app/yoff_q1_1</div>
<div class="line"> </div>
<div class="line"># Set SPAD mask size to 8 x 8</div>
<div class="line">echo 8 &gt; app/xsize_0</div>
<div class="line">echo 8 &gt; app/ysize_0</div>
<div class="line">echo 8 &gt; app/xsize_1</div>
<div class="line">echo 8 &gt; app/ysize_1</div>
<div class="line"> </div>
<div class="line"># Set subcapture 0 to be left half</div>
<div class="line">echo -n &quot;</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">1 1 1 1 0 0 0 0</div>
<div class="line">&quot; &gt; app/spad_mask_0</div>
<div class="line"> </div>
<div class="line"># Set subcapture 1 to be right half</div>
<div class="line">echo -n &quot;</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">0 0 0 0 1 1 1 1</div>
<div class="line">&quot; &gt; app/spad_mask_1</div>
<div class="line"> </div>
<div class="line"># Set subcapture 0 SPAD channel mapping</div>
<div class="line">echo -n &quot;</div>
<div class="line">1 1 2 2 2 2 1 1</div>
<div class="line">1 1 2 2 2 2 1 1</div>
<div class="line">3 3 4 4 4 4 3 3</div>
<div class="line">3 3 4 4 4 4 3 3</div>
<div class="line">5 5 6 6 6 6 5 5</div>
<div class="line">5 5 6 6 6 6 5 5</div>
<div class="line">7 7 8 8 8 8 7 7</div>
<div class="line">7 7 8 8 8 8 7 7</div>
<div class="line">&quot; &gt; app/spad_map_0</div>
<div class="line"> </div>
<div class="line"># Set subcapture 1 SPAD channel mapping</div>
<div class="line">echo -n &quot;</div>
<div class="line">1 1 2 2 2 2 1 1</div>
<div class="line">1 1 2 2 2 2 1 1</div>
<div class="line">3 3 4 4 4 4 3 3</div>
<div class="line">3 3 4 4 4 4 3 3</div>
<div class="line">5 5 6 6 6 6 5 5</div>
<div class="line">5 5 6 6 6 6 5 5</div>
<div class="line">7 7 8 8 8 8 7 7</div>
<div class="line">7 7 8 8 8 8 7 7</div>
<div class="line">&quot; &gt; app/spad_map_1</div>
<div class="line"> </div>
<div class="line"># Commit custom SPAD configuration</div>
<div class="line">echo 1 &gt; app/commit_spad_cfg</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
